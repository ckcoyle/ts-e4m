{"tagline":"Topspin Powered Email For Media Widget","note":"Don't delete this file! It's used internally to help with page regeneration.","name":"TS-E4M","google":"","body":"#[Topspin Powered HTML E4M]\r\n\r\n##Overview\r\nQuickly create an HTML and jQuery powered Topspin Email For Media Widget. Benefits include no Flash reliance, better mobile styling and completely custom interface. The main methods include <a href=\"https://github.com/malsup/form/\">jQuery Form Plugin</a>, cURL, HTML5 form markup and a little bit of Javascript. Writtin in Jade, SASS & Coffee using Compass.\r\n\r\nMaking your own custom HTML E4M doesn't get any easier than this!\r\n\r\n---\r\n \r\n##Installation\r\n\r\n###Include\r\n\r\n````html\r\n<script src=\"javascripts/jquery.min.js\"></script>\r\n<script src=\"javascripts/jquery.form.js\"></script>\r\n````\r\n\r\n###HTML Form\r\nThis markup provides the necessary visible and hidden inputs to properly relay information to the Topspin REST API. Change the `artist_id`, `fan[source_campaign]`, and `fan[referring_url]`, `fan[confirmation_target]`. In order to provide the `fan[source_campaign]`, you will need a relevant Topspin account and an Email For Media widget created within the platform. To locate the `fan[source_campaign]`, simply do the following:\r\n\r\n1. Find the widget_id=\"\" url in your embed code\r\n2. Paste that into a browser\r\n3. Find the url inside the <campaign> tag (ex. http://app.topspin.net/api/v1/artist/1051/campaign/10150220)\r\n\r\nIn order to provide the `fan[confirmation_target]`, you will need to create a new Topspin Labs Download Anywhere URL. Go to http://labs.topspin.net/downloadanywhere/ and enter your credentials. Once generated, replace the `fan[confirmation_target]` value with your unique Download Anywhere URL.\r\n\r\n````html\r\nform#signup(action='send.php', method='post')\r\n\t.twelve.columns\r\n\t\tinput#email.erase.email(name='fan[email]', type='email', value='enter your email here', placeholder='enter your email here')\r\n\t\tinput#artist_id(name='artist_id', value='1051', type='hidden')\r\n\t\tinput#source_campaign(name='fan[source_campaign]', value='http://app.topspin.net/api/v1/artist/1051/campaign/10150220', type='hidden')\r\n\t\tinput#referring_url(name='fan[referring_url]', value='http://www.builtbyeande.com', type='hidden')\r\n\t\tinput#confirmation_target(name='fan[confirmation_target]', value='http://labs.topspin.net/downloadanywhere/confirm.php?sessionid=188a0d0a116380c2180c37a7dcb33e1e', type='hidden')\r\n\t.four.columns\r\n\t\tinput#submit(name='submit', type='submit', value='submit')\r\n````\r\n\r\n###jQuery Form Method\r\n\r\nUtilize jQuery form to submit the form via AJAX. Includes a basic success function that returns \"Thanks, Check Your Inbox!\" when properly submitted.\r\n\r\n````javascript\r\n# ajax submit the form\r\n$(\"#signup\").bind \"submit\", (e) ->\r\n\te.preventDefault()\r\n\t$(\"#signup\").addClass \"loading\"\r\n\t$(this).ajaxSubmit success: ->\r\n\t\t$(\"#signup\").removeClass \"loading\"\r\n\t\t$(\"#email\").val \"Thanks, Check Your Inbox!\"\r\n\t\t$(\"#email, #submit\").prop \"disabled\", true\r\n````\r\n\r\n###jQuery Input Clear\r\n\r\nInclude to handle basic active / inactive states on the HTML form. Provides a clean way to remove the placeholder text when in focus and add it back in when default.\r\n\r\n````javascript\r\n# clear out our form on focus\r\n$(\"input.erase\").each ->\r\n\t$(this).data(\"default\", $(this).val()).addClass(\"inactive\").focus(->\r\n\t\t$(this).removeClass \"inactive\"\r\n\t\t$(this).val \"\"\tif $(this).val() is $(this).data(\"default\") or \"\"\r\n\t).blur ->\r\n\t\tdefault_val = $(this).data(\"default\")\r\n\t\tif $(this).val() is \"\"\r\n\t\t\t$(this).addClass \"inactive\"\r\n\t\t\t$(this).val $(this).data(\"default\")\r\n````\r\n\r\n###cURL PHP\r\n\r\nExtract POST variables from the HTML form, open connection to Topspin API and send relevant fan email information. This will be the function that the HTML form action submits to over AJAX.\r\n\r\n````html\r\n<?php\r\n\r\n\textract($_POST);\r\n\r\n\t//topspin email for media widget\r\n\t\r\n\t//set POST variables\r\n\t$url = 'http://app.topspin.net/api/v1/fan/create_fan';\r\n\t$fields = array(\r\n\t\t'artist_id'=>urlencode($artist_id),\r\n\t\t'fan[source_campaign]'=>urlencode($fan['source_campaign']),\r\n\t\t'fan[email]'=>urlencode($fan['email']),\r\n\t\t'fan[referring_url]'=>urlencode($fan['referring_url']),\r\n\t\t'fan[confirmation_target]'=>urlencode($fan['confirmation_target'])\r\n\t);\r\n\r\n\t//url-ify the data for the POST\r\n\tforeach($fields as $key=>$value) { $fields_string .= $key.'='.$value.'&'; }\r\n\trtrim($fields_string,'&');\r\n\r\n\t$url = $url . '?' . $fields_string;\r\n\r\n\t//open connection\r\n\t$ch = curl_init();\r\n\r\n\t//set the url, number of POST vars, POST data\r\n\tcurl_setopt($ch,CURLOPT_URL,$url);\r\n\t\r\n\theader('Content-type: application/json');\r\n\t\r\n\t//execute post\r\n\t$result = json_decode( curl_exec($ch) );\r\n\r\n\t//close connection\r\n\tcurl_close($ch);\r\n\t\r\n\t\r\n\t$message = array();\r\n\tif($result['success']){\r\n\t\t$message['success'] = true;\r\n\t}else{\r\n\t\t$message['error'] = $result['error'];\r\n\t}\r\n\t\t\r\n\t// and finally return true\r\n\t//header('Content-type: application/json');\r\n\t//echo json_encode($message);\r\n\t\r\n?>\r\n\r\n````\r\n\r\n---\r\n\r\n##Copyright and License\r\nDual licensed under the MIT and GPL licenses:\r\n\r\n* http://www.opensource.org/licenses/mit-license.php\r\n* http://www.gnu.org/licenses/gpl.html\r\n\r\nYou may use the Topspin HTML E4M under the terms of either the MIT License or the GNU General Public License (GPL) Version 2.\r\nThe MIT License is recommended for most projects. It is simple and easy to understand and it places almost no restrictions on what you can do with the plugin.\r\n\r\nIf the GPL suits your project better you are also free to use the plugin under that license.\r\n\r\nYou don't have to do anything special to choose one license or the other and you don't have to notify anyone which license you are using. You are free to use the Topspin HTML E4M in commercial projects.\r\n\r\n---\r\n"}